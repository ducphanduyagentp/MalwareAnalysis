# Lab 01

## Lab 01-01

1.  Both of the files are identified by a lot of antivirus.
2.  Time Date Stamp
    -   Lab01-01.exe: 19/12/2010 16:16:19
    -   Lab01-01.dll: 19/12/2010 16:16:38
3.  No indication that the files are packed or obfuscated.
4.  -   Lab01-01.dll:
        -   WS2_32.dll: Connect to the internet
        -   KERNEL32.dll: Create processes
    -   Lab01-01.exe:
        -   KERNEL32.dll: Create and copy files self-replication
5.  -   Lab01-01.exe:
        -   C:\Windows\system32\kerne1.dll -> disguise
        -   Find
6.  -   Lab01-01.dll:
        -   IP address: 127.26.152.13
7.  Dunno

## Lab01-02

1.  It matches AVs signatures.
2.  ~~File is not packed~~ I was stupid. I opened the file with **PE Explorer** and it unpack the binary by default and I didn't see it was packed. Open it with **CFF Explorer** does the work. Also, LoadLibrary and GetProcAddress was imported so it's highly likely to be packed.
3.  -   *InternetOpen* and *InternetOpenURL*: Connect to the internet
    -   *CreateService*, *OpenSCManager*, *StartServiceCtrlDispatcher*: Persistent
    -   *CreateThread*, *CreateMutex*, *OpenMutex*
4.  -   Domain: hxxp://www.malwareanalysisbook.com
    -   Service: MalService

## Lab01-03

1. Matches 55 AVs
2. Packed: No common section name and virtual size of section is much larger than raw size. Raw size of one section is 0. Opening the PE in CFF explorer yelled FSG packer.
3. Import LoadLibraryA and GetProcAddress -> packed.
4. No significant indicators

## Lab01-04

1. Matches 52 AVs
2. It's not packed. Section names are common.
3. It's compiled on 30/08/2019 22:26:59. **FAKENEWS**
4. Imports:
    -   KERNEL32.dll:
        - CreateFile, WriteFile, MoveFile, WinExec: Replicate
        - FindResource, LoadResource
    -   ADVAPI32.dll:
        - LookupPrivilegeValue, AdjustTokenPrivileges, OpenProcessToken: Probably modify permissions on files.
5.  -   Host-based: \system32\wupdmgr.exe, \winup.exe
    -   Network-based: hxxp://www.practicalmalwareanalysis.com/updater.exe
6.  The resource is a PE (begins with **MZ**). The malware probably spread this PE on the infected system. (Actually it's a downloader. It imports urlmon.dll and definitely downloads more malware to the machine.)
